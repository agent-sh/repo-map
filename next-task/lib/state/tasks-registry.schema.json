{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "tasks-registry.schema.json",
  "title": "Tasks Registry",
  "description": "Registry of claimed/in-progress tasks in the main repo. Used to prevent task collisions across parallel workflows.",
  "type": "object",
  "required": ["version", "tasks"],
  "properties": {
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Schema version",
      "default": "1.0.0"
    },
    "tasks": {
      "type": "array",
      "description": "List of claimed tasks",
      "items": {
        "type": "object",
        "required": ["id", "source", "branch", "worktreePath", "claimedAt"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Task identifier (issue number, Linear ID, etc.)"
          },
          "source": {
            "type": "string",
            "enum": ["github", "linear", "tasks-md", "manual"],
            "description": "Where the task came from"
          },
          "title": {
            "type": "string",
            "description": "Task title for display"
          },
          "branch": {
            "type": "string",
            "description": "Git branch name for this task"
          },
          "worktreePath": {
            "type": "string",
            "description": "Absolute path to the worktree"
          },
          "claimedAt": {
            "type": "string",
            "format": "date-time",
            "description": "When the task was claimed"
          },
          "claimedBy": {
            "type": "string",
            "description": "Session/workflow ID that claimed this task"
          },
          "status": {
            "type": "string",
            "enum": ["claimed", "in-progress", "review", "shipping", "done"],
            "default": "claimed",
            "description": "High-level task status"
          },
          "lastActivityAt": {
            "type": "string",
            "format": "date-time",
            "description": "Last activity timestamp for stale detection"
          }
        }
      }
    }
  },
  "examples": [
    {
      "version": "1.0.0",
      "tasks": [
        {
          "id": "123",
          "source": "github",
          "title": "Add user authentication",
          "branch": "feature/add-user-authentication-123",
          "worktreePath": "/path/to/repo/../worktrees/add-user-authentication-123",
          "claimedAt": "2024-01-15T10:30:00Z",
          "claimedBy": "workflow-20240115-103000-abc123",
          "status": "in-progress",
          "lastActivityAt": "2024-01-15T11:45:00Z"
        }
      ]
    }
  ]
}
